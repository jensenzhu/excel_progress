# Excel智能数据操作助手 - 实施计划

## 项目概述

使用Streamlit + GLM-4.5-Flash构建一个支持多表操作的自然语言Excel数据处理系统

## 实施步骤

### 1. 项目初始化

* 创建项目目录结构（core/, ui/, utils/, config/）

* 生成项目设计文档（design.md）

* 创建requirements.txt（streamlit, pandas, openai, openpyxl等）

* 创建.gitignore文件

### 2. 配置模块

* 创建config/settings.py（GLM-4.5-Flash API配置）

  * API Key: 2a7ec09588b14d14b66d730ac2e5266e.2ATkSDwtRBlgi6Rn

  * Base URL: <https://open.bigmodel.cn/api/paas/v4>

  * Model: glm-4.5-flash

* 创建config/prompts.py（LLM提示词模板）

### 3. 核心模块实现

* **core/data\_manager.py**: 多表数据管理器

  * 加载/保存Excel文件

  * 管理多个DataFrame

  * 单元格读写操作

  * 表格切换

* **core/nlp\_parser.py**: 自然语言解析器

  * 使用GLM-4.5-Flash解析指令

  * 识别表引用、单元格引用、操作类型

  * 支持跨表操作解析

* **core/operation\_engine.py**: 操作执行引擎

  * 单表操作（筛选、计算、排序）

  * 跨表操作（合并、连接、数据迁移）

  * 单元格级操作

  * 操作链执行

* **core/cell\_operations.py**: 单元格操作工具

  * 单元格引用解析（A5 → row/col）

  * 范围解析（A5:C10）

  * 单元格读写

### 4. 工具模块

* **utils/excel\_handler.py**: Excel文件处理

* **utils/validators.py**: 数据验证

### 5. UI组件

* **ui/table\_viewer.py**: 表格展示组件

  * 多表标签页

  * 数据预览

  * 高亮显示选中区域

* **ui/chat\_interface.py**: 聊天界面

  * 自然语言输入

  * 操作历史显示

* **ui/operation\_preview\.py**: 操作预览

  * 显示将要执行的操作

  * 确认/取消机制

### 6. 主应用

* **app.py**: Streamlit主应用

  * 文件上传

  * 表格管理

  * 自然语言交互

  * 结果展示

### 7. 测试和优化

* 创建示例Excel文件

* 测试各种操作场景

* 优化用户体验

## 技术栈

* **前端**: Streamlit

* **数据处理**: Pandas, OpenPyXL

* **LLM**: GLM-4.5-Flash (通过OpenAI兼容API)

* **语言**: Python 3.9+

